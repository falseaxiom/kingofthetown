<!DOCTYPE html>
<html>
    <head>
        <title>King of the Town</title>
        <link rel="stylesheet" href="styles.css"/>
        <link rel="preconnect" href="https://fonts.gstatic.com"> 
        <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    </head>
    <body class="indexBg" id="body">

        <div id="container" style="width: 80%; overflow: hidden">
            <!-- code input -->
            <div class="flexCol hidden" id="intro">
                <span class="title">Hello! Welcome to <span style="color: var(--green)">PART 3</span> of</span>
                <br/>
                <span class="bigTitle">
                    <span style="color: var(--pink)">KING</span> OF THE <span style="color: var(--yellow)">TOWN:</span> <br/>
                    An <span style="color: var(--green)">Inaccurate Personality Test</span><br/>
                    and a <span style="color: var(--blue)">Living Comic Strip.</span>
                </span>
                <br/>
                <span class="title">Please enter the code you received at the end of <span style="color: var(--yellow)">PART 2:</span></span>
                <br/>
                <form
                    class="flexRow"
                    action="./quizp3.html"
                    onSubmit="return true"
                >  
                    <input type="text" id="code" name="code" style="border-color: var(--purple);" placeholder="ex: 12-34-56-78-ABCDE">
                    <button type="submit" class="submitButton" style="background-color: var(--purple);">Enter</button>
                </form>
                <br/>
                <span class="title" style="font-size: 1.5rem; color: rgb(207, 207, 207);">(Be careful--this code has <span style="color: var(--blue)">1 more letter</span> than the code you needed for <span style="color: var(--yellow)">PART 2!</span>)</span>
            </div>

            <!-- pre-scene -->
            <form 
                class="flexCol hidden"
                id="pre"
                action="./quizp3.html"
                onSubmit="return quizPre()"
            >
                <input type="hidden" id="pass1" name="code">
                <span class="title">
                    1. Whatâ€™s your favorite ice cream flavor?
                </span>
                <div><input type="radio" class="" name="q1" id="vanilla" value="vanilla"><label for="vanilla"> Vanilla</label></div>
                <div><input type="radio" class="" name="q1" id="chocolate" value="chocolate"><label for="chocolate"> Chocolate</label></div>
                <div><input type="radio" class="" name="q1" id="strawberry" value="strawberry"><label for="strawberry"> Strawberry</label></div>
                <div><input type="radio" class="" name="q1" id="other" value="other"><label for="other"> Other</label></div>
                <br/>
                <span class="title">
                    2. What is most important to you in a friend/partner?
                </span>
                <div><input type="radio" class="" name="q2" id="honesty" value="honesty"><label for="honesty"> Honesty</label></div>
                <div><input type="radio" class="" name="q2" id="loyalty" value="loyalty"><label for="loyalty"> Loyalty</label></div>
                <div><input type="radio" class="" name="q2" id="empathy" value="empathy"><label for="empathy"> Empathy</label></div>
                <div><input type="radio" class="" name="q2" id="humor" value="humor"><label for="humor"> Sense of humor</label></div>
                <br/>
                <span class="title">
                    3. Have you ever been in love?
                </span>
                <div><input type="radio" class="" name="q3" id="yy" value="yy"><label for="yy"> Yes! I am currently in love. &lt;3</label></div>
                <div><input type="radio" class="" name="q3" id="yn" value="yn"><label for="yn"> Yes, but not anymore. &lt;/3</label></div>
                <div><input type="radio" class="" name="q3" id="n" value="n"><label for="n"> No.</label></div>
                <div><input type="radio" class="" name="q3" id="s" value="s"><label for="s"> I'm not sure...</label></div>
                <br/>
                <button type="submit" class="submitButton" onclick="quizPre()">Submit</button>
            </form>

            <!-- video 3 -->
            <div class="flexCol hidden" id="vid3">
                <span class="title" style="align-self: center;">Please watch SCENE 3 before continuing.</span>
                <video width="1080" height="720" style="align-self: center;" controls>
                    <source src="vids/vid3.mov" type="video/mp4">
                    no video :(
                </video>
                <br/>
                <form
                    class="flexCol"
                    action="./quizp3.html"
                    onSubmit="return vid3func()"
                >
                    <input type="hidden" id="passv3" name="code">
                    <button type="submit" class="submitButton" onclick="vid3func()">Continue</button>
                </form>
            </div>

            <!-- post-scene -->
            <form 
                class="flexCol hidden"
                id="post"
                action="./quizp3.html"
                onSubmit="return quizPost()"
            >
                <input type="hidden" id="pass2" name="code">
                <span class="title">
                    4. Should <span style="color: var(--yellow)">Senator Tomromadrom</span> enter the <span style="color: var(--blue)">Simulation?</span>
                </span>
                <div><input type="radio" class="" name="q4" id="go" value="go"><label for="go"> <span style="color: var(--green)">Enter</span> the <span style="color: var(--blue)">Simulation</span></label></div>
                <div><input type="radio" class="" name="q4" id="stay" value="stay"><label for="stay"> <span style="color: var(--pink)">Don't Enter</span> the <span style="color: var(--blue)">Simulation</span></label></div>
                <br/>
                <button type="submit" class="submitButton" onclick="quizPost()">Submit</button>
            </form>

            <!-- video 4.1 -->
            <div class="flexCol hidden" id="vid41">
                <span>please watch video 4.1 before continuing</span>
                <form
                    class="flexCol"
                    action="./quizp3.html"
                    onSubmit="return vid4func()"
                >
                    <input type="hidden" id="passv41" name="code">
                    <button type="submit" class="submitButton" onclick="vid4func()">Continue</button>
                </form>
            </div>

            <!-- video 4.2 -->
            <div class="flexCol hidden" id="vid42">
                <span>please watch video 4.2 before continuing</span>
                <form
                    class="flexCol"
                    action="./quizp3.html"
                    onSubmit="return vid4func()"
                >
                    <input type="hidden" id="passv42" name="code">
                    <button type="submit" class="submitButton" onclick="vid4func()">Continue</button>
                </form>
            </div>

            <!-- post-scene 2 -->
            <form 
                class="flexCol hidden"
                id="post2"
                action="./quizp3.html"
                onSubmit="return quizPost2()"
            >
                <input type="hidden" id="pass3" name="code">
                <span class="title">
                    5. Should you <span style="color: var(--green)">go back</span> to <span style="color: var(--yellow)">3005</span>, or should you <span style="color: var(--pink)">stay</span> in the <span style="color: var(--blue)">Simulation?</span>
                </span>
                <div><input type="radio" class="" name="q5" id="go" value="go"><label for="go"> <span style="color: var(--green)">Go back</span> to <span style="color: var(--yellow)">3005</span></label></div>
                <div><input type="radio" class="" name="q5" id="stay" value="stay"><label for="stay"> <span style="color: var(--pink)">Stay</span> in the <span style="color: var(--blue)">Simulation</span></label></div>
                <br/>
                <button type="submit" class="submitButton" onclick="quizPost2()">Submit</button>
            </form>

            <!-- video 5.1 -->
            <div class="flexCol hidden" id="vid51">
                <span class="title">
                    <span style="color: var(--yellow)">Surprise!</span> That answer <span style="color: var(--pink)">didn't matter.</span> 
                    You already made your choice, starting from the <span style="color: var(--blue)">first question</span> you answered. 
                    Hereâ€™s what you decided should happen to <span style="color: var(--green)">Conrad:</span>
                </span>
                <span>please watch video 5.1 before continuing</span>
                <form
                    class="flexCol"
                    action="./quizp3.html"
                    onSubmit="return vid5func()"
                >
                    <input type="hidden" id="passv51" name="code">
                    <button type="submit" class="submitButton" onclick="vid5func()">Continue</button>
                </form>
            </div>

            <!-- video 5.2 -->
            <div class="flexCol hidden" id="vid52">
                <span class="title">
                    <span style="color: var(--yellow)">Surprise!</span> That answer <span style="color: var(--pink)">didn't matter.</span> 
                    You already made your choice, starting from the <span style="color: var(--blue)">first question</span> you answered. 
                    Hereâ€™s what you decided should happen to <span style="color: var(--green)">Conrad:</span>
                </span>
                <span>please watch video 5.2 before continuing</span>
                <form
                    class="flexCol"
                    action="./quizp3.html"
                    onSubmit="return vid5func()"
                >
                    <input type="hidden" id="passv52" name="code">
                    <button type="submit" class="submitButton" onclick="vid5func()">Continue</button>
                </form>
            </div>

            <!-- video 5.3 -->
            <div class="flexCol hidden" id="vid53">
                <span class="title">
                    <span style="color: var(--yellow)">Surprise!</span> That answer <span style="color: var(--pink)">didn't matter.</span> 
                    You already made your choice, starting from the <span style="color: var(--blue)">first question</span> you answered. 
                    Hereâ€™s what you decided should happen to <span style="color: var(--green)">Conrad:</span>
                </span>
                <span>please watch video 5.3 before continuing</span>
                <form
                    class="flexCol"
                    action="./quizp3.html"
                    onSubmit="return vid5func()"
                >
                    <input type="hidden" id="passv53" name="code">
                    <button type="submit" class="submitButton" onclick="vid5func()">Continue</button>
                </form>
            </div>

            <!-- test results -->
            <div class="flexCol hidden" id="results">
                <span class="title">CONGRATULATIONS!</span>
                <span class="title">You have completed <span style="color: var(--green)">PART 3</span> of this adventure.</span>
                <span class="title">Based on your answers to the personality test, you are:</span>
                <div class="flexCol hidden" id="conrad">
                    <span class="bigTitle" style="color: var(--green)">CONRAD!</span>
                    <span class="title">
                        You are <span style="color: var(--pink)">enthusiastic,</span> <span style="color: var(--blue)">dreamy,</span> 
                        and always looking on the <span style="color: var(--yellow)">bright side</span> of things. This is one of your 
                        great <span style="color: var(--green)">strengths,</span> as you are a <span style="color: var(--pink)">resilient</span> 
                        and <span style="color: var(--yellow)">positive</span> presence. You have an <span style="color: var(--blue)">artistic nature</span> 
                        that can manifest in <span style="color: var(--blue)">music</span> or other energies! However, just because you are 
                        <span style="color: var(--yellow)">positive</span> and <span style="color: var(--green)">self-content</span> doesnâ€™t mean
                        you shouldnâ€™t take <span style="color: var(--pink)">risks!</span> Sometimes, even if a decision would mean something 
                        <span style="color: var(--yellow)">scary</span> or <span style="color: var(--green)">uncomfortable</span> to your 
                        current way of life, itâ€™s still one you should take.   
                    </span>
                </div>
                <div class="flexCol hidden" id="jamie">
                    <span class="bigTitle" style="color: var(--blue)">JAMIE!</span>
                    <span class="title">
                        Youâ€™re constantly looking to the <span style="color: var(--green)">future.</span> Youâ€™re <span style="color: var(--pink)">bold,</span> 
                        <span style="color: var(--yellow)">innovative,</span> and not afraid to get out there, and youâ€™re often the 
                        <span style="color: var(--blue)">life of the party.</span> <span style="color: var(--green)">Outgoing</span> and 
                        <span style="color: var(--pink)">exuberant,</span> you have a way about you that makes people <span style="color: var(--blue)">sit up</span> and 
                        <span style="color: var(--yellow)">listen.</span> But you also have a <span style="color: var(--blue)">quieter</span> side, 
                        so make sure to listen to it! After all, <span style="color: var(--green)">life</span> isnâ€™t just about what 
                        <span style="color: var(--yellow)">other people</span> think about you. Go out there and 
                        <span style="color: var(--pink)">grab</span> it.   
                    </span>
                </div>
                <div class="flexCol hidden" id="minoshka">
                    <span class="bigTitle" style="color: var(--pink)">MINOSHKA!</span>
                    <span class="title">
                        Youâ€™re a bit of a <span style="color: var(--yellow)">nutcase,</span> and thatâ€™s why people <span style="color: var(--pink)">love</span> you! 
                        Youâ€™re a <span style="color: var(--green)">go-getter</span> and an emitter of <span style="color: var(--blue)">undiluted positive vibes.</span> 
                        You also seem to have <span style="color: var(--green)">unlimited energy,</span> a <span style="color: var(--pink)">social butterfly</span> that 
                        is <span style="color: var(--yellow)">everywhere at once.</span> People are <span style="color: var(--blue)">drawn</span> to you for what you 
                        have to say, but <span style="color: var(--yellow)">be careful</span> - sometimes those <span style="color: var(--green)">manic vibes</span> 
                        can make you <span style="color: var(--pink)">self-combust.</span>
                    </span>
                </div>
                <div class="flexCol hidden" id="senator">
                    <span class="bigTitle" style="color: var(--yellow)">SENATOR TOMROMADROM!</span>
                    <span class="title">
                        <span style="color: var(--blue)">Experienced</span> and <span style="color: var(--green)">self-confident</span> you are the voice of 
                        <span style="color: var(--yellow)">authority</span> in the room. Youâ€™re <span style="color: var(--pink)">comfortable</span> in 
                        <span style="color: var(--yellow)">command</span> and making <span style="color: var(--green)">executive decisions,</span> and youâ€™re 
                        always <span style="color: var(--blue)">looking out for yourself,</span> even if it means impersonating a <span style="color: var(--willow)">tree.</span> 
                        Itâ€™s a great <span style="color: var(--green)">strength</span> to be so <span style="color: var(--pink)">self-assured</span> and <span style="color: var(--yellow)">driven,</span> 
                        but make sure to <span style="color: var(--pink)">appreciate</span> the <span style="color: var(--blue)">people around you</span> every now and then.
                    </span>
                </div>
                <div class="flexCol hidden" id="willow">
                    <span class="bigTitle" style="color: var(--willow)">WILLOW!(???)</span>
                    <span class="title">
                        You are an <span style="color: var(--willow)">old soul, firmly rooted</span> and <span style="color: var(--willow)">stable.</span> People 
                        <span style="color: var(--willow)">lean on you</span> for <span style="color: var(--willow)">support,</span> and what can you do but 
                        <span style="color: var(--willow)">help?</span> However, make sure youâ€™re also <span style="color: var(--willow)">taking care of yourself.</span> 
                        It can be <span style="color: var(--willow)">hard</span> sometimes, being an <span style="color: var(--willow)">old willow tree</span> - but 
                        try not to get too <span style="color: var(--willow)">grumpy</span> with those <span style="color: var(--willow)">young folks</span> gallivanting 
                        about, and <span style="color: var(--willow)">stop</span> and <span style="color: var(--willow)">smell the roses!</span> (Or whatever rose petals 
                        float your way, since, you know, you donâ€™t move around too much.)
                    </span>
                    <span class="title">
                        You weren't supposed to be able to get this result, but maybe you're just built different. ðŸ˜³
                    </span>
                </div>
                <br/>
                <form
                    class="flexCol"
                    action="./quizp3.html"
                    onSubmit="return quizRes()"
                >
                    <input type="hidden" id="pass4" name="code">
                    <button type="submit" class="submitButton" onclick="quizRes()">Continue</button>
                </form>
            </div>

            <!-- exit -->
            <div class="flexCol hidden" id="done">
                <span class="title">Thank you for playing</span>
                <br/>
                <span class="bigTitle">
                    <span style="color: var(--pink)">KING</span> OF THE <span style="color: var(--yellow)">TOWN:</span> <br/>
                    An <span style="color: var(--green)">Inaccurate Personality Test</span><br/>
                    and a <span style="color: var(--blue)">Living Comic Strip.</span>
                </span>
                <br/>
                <span class="title">Please reset this machine for the next player by clicking the button below. Have a lovely day! :)</span>
                <br/>
                <button type="submit" class="submitButton" onclick="location.href = './quizp3.html?code=0-0-0-0-';">Reset</button>
            </div>
        </div>

        <!-- admin only - return to index -->
        <a style="position: absolute; bottom: 1vh; left: 1vw; font-size: 1rem;" href="./">
            index
        </a>
    </body>
    <script>
        // get part/code
        let param = window.location.href.split("?");
        let p;
        if (param.length > 1) p = param[1].split(/=|&/);
        console.log(p)

        // CHARACTER VARS & CHARTSTRING
        let scores = p[1].split("-");
        let conrad = parseInt(scores[0]);
        let jamie = parseInt(scores[1]);
        let minoshka = parseInt(scores[2]);
        let senator = parseInt(scores[3]);
        let str = scores[4];
        let sg1 = str.substring(0,1);
        let sg2 = str.substring(1,2);
        let widget = str.substring(2);
        console.log(scores)

        // SECTIONS
        let intro = document.getElementById("intro");
        let pre = document.getElementById("pre");
        let vid3 = document.getElementById("vid3");
        let post = document.getElementById("post");
        let vid41 = document.getElementById("vid41");
        let vid42 = document.getElementById("vid42");
        let post2 = document.getElementById("post2");
        let vid51 = document.getElementById("vid51");
        let vid52 = document.getElementById("vid52");
        let vid53 = document.getElementById("vid53");
        let results = document.getElementById("results");
        let done = document.getElementById("done");

        // change theme as appropriate
        console.log(sg2)
        if (widget === "PRE" && sg2 === "G") {
            console.log("metro mode ACTIVATE")

            // change bg and text
            document.getElementById("body").className = "metro";

            // change buttons
            let buttons = document.getElementsByClassName("submitButton");
            buttons = Array.from(buttons);
            buttons.forEach(b => b.className = "submitButton metroButton");

            // change radios
            let radios = document.querySelectorAll('input[type=radio]');
            radios = Array.from(radios);
            radios.forEach(r => r.className = "metroRadio");
        }
        else if (widget === "PRE" && sg2 === "S") {
            console.log("town mode ACTIVATE")
            
            // change bg and text
            document.getElementById("body").className = "town";

            // change buttons
            let buttons = document.getElementsByClassName("submitButton");
            buttons = Array.from(buttons);
            buttons.forEach(b => b.className = "submitButton townButton");

            // change radios
            let radios = document.querySelectorAll('input[type=radio]');
            radios = Array.from(radios);
            radios.forEach(r => r.className = "townRadio");
        }

        // hide widgets as appropriate
        console.log(widget)
        if (widget === "PRE") pre.className = "flexCol";
        else if (widget === "V3") vid3.className = "flexCol";
        else if (widget === "POST") post.className = "flexCol";
        else if (widget === "E") vid41.className = "flexCol";
        else if (widget === "D") vid42.className = "flexCol";
        else if (widget === "EPOST2" || widget === "DPOST2") post2.className = "flexCol";
        else if (widget === "J" || widget === "M") vid51.className = "flexCol";
        else if (widget === "C") vid52.className = "flexCol";
        else if (widget === "S") vid53.className = "flexCol";
        else if (widget.substring(1) === "RESULTS") {
            results.className = "flexCol";
            let res = widget.substring(0,1);
            if (res === "C") document.getElementById("conrad").className = "flexCol";
            else if (res === "J") document.getElementById("jamie").className = "flexCol";
            else if (res === "M") document.getElementById("minoshka").className = "flexCol";
            else if (res === "S") document.getElementById("senator").className = "flexCol";
            else document.getElementById("willow").className = "flexCol";
        }
        else if (widget === "DONE") done.className = "flexCol";
        else intro.className = "flexCol";

        // if not a survey slide, hide radios
        if (!(widget === "PRE" || widget === "POST" || widget === "POST2")) {
            let radios = document.querySelectorAll('input[type=radio]');
            radios = Array.from(radios);
            radios.forEach(r => r.className = "hidden");
        }
        
        function quizPre() {
            // question 1
            let q1 = document.getElementsByName("q1");
            if (q1[0].checked)      conrad++;
            else if (q1[1].checked) jamie++;
            else if (q1[2].checked) minoshka++;
            else                    senator++;

            // question 2
            let q2 = document.getElementsByName("q2");
            if (q2[0].checked)      senator++;
            else if (q2[1].checked) jamie++;
            else if (q2[2].checked) conrad++;
            else                    minoshka++;

            // question 3
            let q3 = document.getElementsByName("q3");
            if (q3[0].checked)      conrad++;
            else if (q3[1].checked) jamie++;
            else if (q3[2].checked) senator++;
            else                    minoshka++;

            // move on to video 2.1 or 2.2
            str = sg1 + sg2 + "V3";
            
            // pass
            let pass1 = document.getElementById("pass1");
            pass1.value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + str;
        }
        function vid3func() {
            document.getElementById("passv3").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + sg1 + sg2 + "POST";
        }
        function quizPost() {
            // question 4
            let q4 = document.getElementsByName("q4");
            if (q4[0].checked) { senator++; minoshka++; str=sg1+sg2+"E"; }
            else               { conrad++; jamie++; str=sg1+sg2+"D"; }
            
            let pass2 = document.getElementById("pass2");
            pass2.value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + str;
        }
        function vid4func() {
            document.getElementById("passv41").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + str + "POST2";
            document.getElementById("passv42").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + str + "POST2";
        }
        function quizPost2() {
            // question 5
            let q5 = document.getElementsByName("q5");
            if (q5[0].checked) { senator++; minoshka++; }
            else               { conrad++; jamie++; }

            // who won?
            winner = Math.max(Math.max(conrad, jamie), Math.max(senator, minoshka));
            if (winner == conrad)       str = sg1 + sg2 + "C";
            else if (winner == jamie)   str = sg1 + sg2 + "J";
            else if (winner == minoshka) str = sg1 + sg2 + "M";
            else                        str = sg1 + sg2 + "S";

            // randomize for willow
            let randy = Math.random();
            if (randy < 0.001) str = sg1 + sg2 + "W";

            
            let pass2 = document.getElementById("pass3");
            pass2.value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + str;
        }
        function vid5func() {
            document.getElementById("passv51").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + str + "RESULTS";
            document.getElementById("passv52").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + str + "RESULTS";
            document.getElementById("passv52").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + str + "RESULTS";
        }
        function quizRes() {
            document.getElementById("pass4").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + sg1 + sg2 + "DONE";
            document.getElementById("pass4").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + sg1 + sg2 + "DONE";
            document.getElementById("pass4").value = conrad + "-" + jamie + "-" + minoshka + "-" + senator + "-" + sg1 + sg2 + "DONE";
        }
    </script>
</html>